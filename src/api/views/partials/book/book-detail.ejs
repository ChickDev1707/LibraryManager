<% contentFor('head') %> 
<title>Book Details</title>
<script src="/public/js/register-borrow-book.js"></script>
<% contentFor('body') %> 
<h1 class="container">Book Details</h1>

<div class="container">
    <div class="row">
        <div class="col-4">
            <img class="img-fluid"  height="600" width="400" src="../../../public/assets/images/default-book-cover.png">
            <br>
            <br>
            <% if(user == 'reader'){ %>
                <form action="/reader/cart" method="POST">
                    <input name="bookHeadId" type="text" hidden value="<%= bookHead._id%>">
                    <button class="btn btn-primary" type="submit">Mượn sách</button>
                </form>
            <% }else{ %>
                <form action='/login' method="GET">
                    <input type="text" name="message" value="Đăng nhập để đăng ký mượn sách" hidden>
                    <input type="text" name="type" value="info" hidden>
                    <button class="btn btn-primary" type="submit">Mượn sách</button>
                </form>
            <% } %> 

            <form action="/reader/favorite-books" method="POST">
                <input name="bookHeadIdFavorite" type="text" hidden value="<%= bookHead._id%>">
                <button class="btn btn-primary" type="submit">Add Favorite Book</button>
            </form>
        </div>
        <div class="col-8">
            <div>
                <label><b>Title:</b></label>
                <%= bookHead.ten_dau_sach %>
            </div>
            <div>
                <label><b>Author:</b></label>
                <%= bookHead.tac_gia %>
            </div>
            <div>
                <label><b>Category:</b></label>
                <%= bookHead.the_loai.ten_the_loai %>
            </div>
            <div>
                <label><b>Publisher:</b></label>
                <%= bookHead.nha_xuat_ban %>
            </div>
            <div>
                <label><b>Published Year:</b></label>
                <%= bookHead.nam_xuat_ban %>
            </div>
            <div>
                <label><b>Price:</b></label>
                <%= bookHead.gia %>
            </div>
            <div>
                <label><b>Description:</b></label>
                <%= bookHead.tom_tat %>
            </div>
        </div>
    </div>
</div>
<br>
<div class="container">
    <div>
        <br>
        <h3>Comment</h3>
        <div>
            <form action="/comment/<%= bookHead.id %>" method="post">
                <div class="row">
                    <div class="col-9">
                        <input class="form-control" type="text"  placeholder="comment here..." name="commentInput">
                    </div>
                    <div class="col-1">
                        <button class="btn btn-primary" type="submit">Comment</button>
                    </div>
                </div>
            </form>
        </div>
        <br>
    </div>
    <div>
        <% bookHead.cac_nhan_xet.forEach(comment => { %>
            <div>
                <span>
                    <b><%= comment.doc_gia.ho_ten %></b>
                    <i><small><%= comment.ngay_dang.toLocaleDateString("VN", { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) %></small></i>
                </span>
                <br>
                <span><%= comment.noi_dung %></span>
            </div>
            <br>
        <% }) %>   
    </div>
</div>